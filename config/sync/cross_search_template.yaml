# 跨表搜索專用索引模板
cross_search:
  index_name: erp-cross-search
  
  # 索引設定
  settings:
    number_of_shards: 2
    number_of_replicas: 0
    refresh_interval: 1s
    
    # 分析器設定
    analysis:
      analyzer:
        # 跨表搜索分析器
        cross_search_analyzer:
          type: custom
          char_filter:
            - html_strip
          tokenizer: ik_max_word
          filter:
            - lowercase
            - synonym_filter
            - stop_words_filter
            
        # 搜索時使用的分析器
        cross_search_query:
          type: custom
          tokenizer: ik_smart
          filter:
            - lowercase
            - synonym_filter
      
      # 同義詞過濾器
      filter:
        synonym_filter:
          type: synonym
          synonyms_path: analysis-ik/synonyms.txt
        stop_words_filter:
          type: stop
          stopwords_path: analysis-ik/stopwords.txt
  
  # 映射設定
  mappings:
    properties:
      # 文檔類型
      doc_type:
        type: keyword
      
      # 統一的 ID
      unified_id:
        type: keyword
      
      # 主要搜索內容
      title:
        type: text
        analyzer: cross_search_analyzer
        search_analyzer: cross_search_query
        fields:
          keyword:
            type: keyword
          suggest:
            type: completion
      
      # 詳細內容
      content:
        type: text
        analyzer: cross_search_analyzer
        search_analyzer: cross_search_query
      
      # 標籤
      tags:
        type: keyword
      
      # 分類
      category:
        type: keyword
      
      # 關聯數據
      related_ids:
        type: nested
        properties:
          type:
            type: keyword
          id:
            type: keyword
      
      # 數值範圍（用於過濾）
      numeric_values:
        type: object
        properties:
          price:
            type: double
          quantity:
            type: integer
          amount:
            type: double
      
      # 日期範圍
      date_values:
        type: object
        properties:
          created_date:
            type: date
          modified_date:
            type: date
          order_date:
            type: date
      
      # 搜索權重
      boost_score:
        type: float
      
      # 簡繁體版本
      content_simplified:
        type: text
        analyzer: ik_max_word
      
      content_traditional:
        type: text
        analyzer: ik_max_word
      
      # 元數據
      _metadata:
        properties:
          source_index:
            type: keyword
          source_id:
            type: keyword
          last_updated:
            type: date
